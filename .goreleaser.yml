builds:
  - main: cmd/exoip/main.go
    binary: exoip
    env:
      - CGO_ENABLED=0
    goos:
      - linux
    goarch:
      - amd64

signs:
  -
    cmd: gpg
    args: ["-u", "ops@exoscale.ch", "--detach-sign", "${artifact}"]
    artifacts: all

dockers:
  -
    dockerfile: Dockerfile.minimal
    binaries: [exoip]
    skip_push: true
    image_templates:
      - "exoscale/exoip:{{ .Tag }}"
      - "exoscale/exoip:latest"

nfpms:
  -
    vendor: Exoscale
    homepage: https://www.exoscale.com
    maintainer: Exoscale Support <support@exoscale.com>
    description: Heartbeat monitor for Exoscale Elastic IP Addresses
    license: Apache 2.0
    formats:
      - deb
      - rpm

dist: build

release:
  github:
    owner: exoscale
    name: exoip
  draft: true
